/*! 
 Build based on gin-vue-admin 
 Time : 1754566973000 */
var e=(e,t,a)=>new Promise(((l,o)=>{var s=e=>{try{u(a.next(e))}catch(t){o(t)}},n=e=>{try{u(a.throw(e))}catch(t){o(t)}},u=e=>e.done?l(e.value):Promise.resolve(e.value).then(s,n);u((a=a.apply(e,t)).next())}));import{r as t,b as a,o as l,c as o,d as s,f as n,w as u,g as d,t as r,D as i,e as c,$ as m,a0 as h,h as y,a1 as p,B as f}from"../gva/pixel-index.1754566973000.js";import{u as v}from"./pixel-authority.17545669730002.js";import{g as I,s as k}from"./pixel-authorityBtn.1754566973000.js";const g={class:"clearflex"},w={class:"custom-tree-node"},b={key:0},x={class:"dialog-footer"},C=Object.assign({name:"Menus"},{props:{row:{default:function(){return{}},type:Object}},emits:["changeRow"],setup(C,{expose:_,emit:R}){const D=C,j=R,z=t([]),N=t([]),B=t(!1),A=t({children:"children",label:function(e){return e.meta.title}});(()=>{e(this,null,(function*(){const e=yield m();z.value=e.data.menus;const t=(yield h({authorityId:D.row.authorityId})).data.menus,a=[];t.forEach((e=>{t.some((t=>t.parentId===e.menuId))||a.push(Number(e.menuId))})),N.value=a}))})();const E=t=>e(this,null,(function*(){const e=yield v({authorityId:D.row.authorityId,AuthorityName:D.row.authorityName,parentId:D.row.parentId,defaultRouter:t.name});0===e.code&&(y({type:"success",message:"设置成功"}),j("changeRow","defaultRouter",e.data.authority.defaultRouter))})),V=()=>{B.value=!0},O=t(null),P=()=>e(this,null,(function*(){const e=O.value.getCheckedNodes(!1,!0);0===(yield p({menus:e,authorityId:D.row.authorityId})).code&&y({type:"success",message:"菜单设置成功!"})}));_({enterAndNext:()=>{P()},needConfirm:B});const S=t(!1),T=t([]),M=t([]),U=t();let $="";const q=t=>e(this,null,(function*(){$=t.ID;const e=yield I({menuID:$,authorityId:D.row.authorityId});0===e.code&&(G(t),yield f(),e.data.selected&&e.data.selected.forEach((e=>{T.value.some((t=>{t.ID===e&&U.value.toggleRowSelection(t,!0)}))})))})),F=e=>{M.value=e},G=e=>{S.value=!0,T.value=e.menuBtn},H=()=>{S.value=!1},J=()=>e(this,null,(function*(){const e=M.value.map((e=>e.ID));0===(yield k({menuID:$,selected:e,authorityId:D.row.authorityId})).code&&(y({type:"success",message:"设置成功"}),S.value=!1)}));return(e,t)=>{const m=a("el-button"),h=a("el-tree"),y=a("el-table-column"),p=a("el-table"),f=a("el-dialog");return l(),o("div",null,[s("div",g,[n(m,{class:"fl-right",size:"small",type:"primary",onClick:P},{default:u((()=>t[1]||(t[1]=[d("确 定")]))),_:1})]),n(h,{ref_key:"menuTree",ref:O,data:z.value,"default-checked-keys":N.value,props:A.value,"default-expand-all":"","highlight-current":"","node-key":"ID","show-checkbox":"",onCheck:V},{default:u((({node:e,data:a})=>[s("span",w,[s("span",null,r(e.label),1),s("span",null,[n(m,{type:"text",size:"small",style:i({color:C.row.defaultRouter===a.name?"#E6A23C":"#85ce61"}),disabled:!e.checked,onClick:()=>E(a)},{default:u((()=>[d(r(C.row.defaultRouter===a.name?"首页":"设为首页"),1)])),_:2},1032,["style","disabled","onClick"])]),a.menuBtn.length?(l(),o("span",b,[n(m,{type:"text",size:"small",onClick:()=>q(a)},{default:u((()=>t[2]||(t[2]=[d(" 分配按钮 ")]))),_:2},1032,["onClick"])])):c("",!0)])])),_:1},8,["data","default-checked-keys","props"]),n(f,{modelValue:S.value,"onUpdate:modelValue":t[0]||(t[0]=e=>S.value=e),title:"分配按钮","destroy-on-close":""},{footer:u((()=>[s("div",x,[n(m,{size:"small",onClick:H},{default:u((()=>t[3]||(t[3]=[d("取 消")]))),_:1}),n(m,{size:"small",type:"primary",onClick:J},{default:u((()=>t[4]||(t[4]=[d("确 定")]))),_:1})])])),default:u((()=>[n(p,{ref_key:"btnTableRef",ref:U,data:T.value,"row-key":"ID",onSelectionChange:F},{default:u((()=>[n(y,{type:"selection",width:"55"}),n(y,{label:"按钮名称",prop:"name"}),n(y,{label:"按钮备注",prop:"desc"})])),_:1},8,["data"])])),_:1},8,["modelValue"])])}}});export{C as default};
