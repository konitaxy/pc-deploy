/*! 
 Build based on gin-vue-admin 
 Time : 1754288963000 */
var e=Object.defineProperty,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,u=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t,o=(e,l,a)=>new Promise(((t,u)=>{var o=e=>{try{s(a.next(e))}catch(l){u(l)}},i=e=>{try{s(a.throw(e))}catch(l){u(l)}},s=e=>e.done?t(e.value):Promise.resolve(e.value).then(o,i);s((a=a.apply(e,l)).next())}));import{g as i,d as s,a as d,u as r,c as n,b as p}from"./pixel-api.17542889630002.js";import{w as c}from"./pixel-warningBar.1754288963000.js";import{_ as v,r as m,b as f,o as h,c as g,d as b,f as y,w as _,G as w,H as V,l as C,g as x,t as k,h as z,Y as A}from"../gva/pixel-index.1754288963000.js";const I={class:"gva-search-box"},P={class:"gva-table-box"},G={class:"gva-btn-list"},U={style:{"text-align":"right","margin-top":"8px"}},j={class:"gva-pagination"},O={class:"dialog-footer"};var D=v(Object.assign({name:"Api"},{setup(e){const v=e=>{const l=T.value.filter((l=>l.value===e))[0];return l&&`${l.label}`},D=m([]),S=m({path:"",apiGroup:"",method:"",description:""}),T=m([{value:"POST",label:"创建",type:"success"},{value:"GET",label:"查看",type:""},{value:"PUT",label:"更新",type:"warning"},{value:"DELETE",label:"删除",type:"danger"}]),$=m(""),E=m({path:[{required:!0,message:"请输入api路径",trigger:"blur"}],apiGroup:[{required:!0,message:"请输入组名称",trigger:"blur"}],method:[{required:!0,message:"请选择请求方式",trigger:"blur"}],description:[{required:!0,message:"请输入api介绍",trigger:"blur"}]}),q=m(1),B=m(0),F=m(10),L=m([]),H=m({}),K=()=>{H.value={}},Y=()=>{q.value=1,F.value=10,N()},Z=e=>{F.value=e,N()},J=e=>{q.value=e,N()},M=({prop:e,order:l})=>{var a;e&&("ID"===e&&(e="id"),H.value.orderKey="ID"===(a=e)?"ID":a.replace(/([A-Z])/g,"_$1").toLowerCase(),H.value.desc="descending"===l),N()},N=()=>o(this,null,(function*(){const e=yield i(((e,o)=>{for(var i in o||(o={}))a.call(o,i)&&u(e,i,o[i]);if(l)for(var i of l(o))t.call(o,i)&&u(e,i,o[i]);return e})({page:q.value,pageSize:F.value},H.value));0===e.code&&(L.value=e.data.list,B.value=e.data.total,q.value=e.data.page,F.value=e.data.pageSize)}));N();const Q=e=>{D.value=e},R=m(!1),W=()=>o(this,null,(function*(){const e=D.value.map((e=>e.ID)),l=yield s({ids:e});0===l.code&&(z({type:"success",message:l.msg}),L.value.length===e.length&&q.value>1&&q.value--,R.value=!1,N())})),X=m(null),ee=m("新增Api"),le=m(!1),ae=e=>{switch(e){case"addApi":ee.value="新增Api";break;case"edit":ee.value="编辑Api"}$.value=e,le.value=!0},te=()=>{X.value.resetFields(),S.value={path:"",apiGroup:"",method:"",description:""},le.value=!1},ue=e=>o(this,null,(function*(){const l=yield d({id:e.ID});S.value=l.data.api,ae("edit")})),oe=()=>o(this,null,(function*(){X.value.validate((e=>o(this,null,(function*(){if(e)switch($.value){case"addApi":0===(yield n(S.value)).code&&z({type:"success",message:"添加成功",showClose:!0}),N(),te();break;case"edit":0===(yield r(S.value)).code&&z({type:"success",message:"编辑成功",showClose:!0}),N(),te();break;default:z({type:"error",message:"未知操作",showClose:!0})}}))))})),ie=e=>o(this,null,(function*(){A.confirm("此操作将永久删除所有角色下该api, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>o(this,null,(function*(){0===(yield p(e)).code&&(z({type:"success",message:"删除成功!"}),1===L.value.length&&q.value>1&&q.value--,N())}))))}));return(e,l)=>{const a=f("el-input"),t=f("el-form-item"),u=f("el-option"),o=f("el-select"),i=f("el-button"),s=f("el-form"),d=f("el-popover"),r=f("el-table-column"),n=f("el-table"),p=f("el-pagination"),m=f("el-dialog");return h(),g("div",null,[b("div",I,[y(s,{ref:"searchForm",inline:!0,model:H.value},{default:_((()=>[y(t,{label:"路径"},{default:_((()=>[y(a,{modelValue:H.value.path,"onUpdate:modelValue":l[0]||(l[0]=e=>H.value.path=e),placeholder:"路径"},null,8,["modelValue"])])),_:1}),y(t,{label:"描述"},{default:_((()=>[y(a,{modelValue:H.value.description,"onUpdate:modelValue":l[1]||(l[1]=e=>H.value.description=e),placeholder:"描述"},null,8,["modelValue"])])),_:1}),y(t,{label:"API组"},{default:_((()=>[y(a,{modelValue:H.value.apiGroup,"onUpdate:modelValue":l[2]||(l[2]=e=>H.value.apiGroup=e),placeholder:"api组"},null,8,["modelValue"])])),_:1}),y(t,{label:"请求"},{default:_((()=>[y(o,{modelValue:H.value.method,"onUpdate:modelValue":l[3]||(l[3]=e=>H.value.method=e),clearable:"",placeholder:"请选择"},{default:_((()=>[(h(!0),g(w,null,V(T.value,(e=>(h(),C(u,{key:e.value,label:`${e.label}(${e.value})`,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),y(t,null,{default:_((()=>[y(i,{size:"small",type:"primary",icon:"search",onClick:Y},{default:_((()=>l[13]||(l[13]=[x("查询")]))),_:1}),y(i,{size:"small",icon:"refresh",onClick:K},{default:_((()=>l[14]||(l[14]=[x("重置")]))),_:1})])),_:1})])),_:1},8,["model"])]),b("div",P,[b("div",G,[y(i,{size:"small",type:"primary",icon:"plus",onClick:l[4]||(l[4]=e=>ae("addApi"))},{default:_((()=>l[15]||(l[15]=[x("新增")]))),_:1}),y(d,{visible:R.value,"onUpdate:visible":l[7]||(l[7]=e=>R.value=e),placement:"top",width:"160"},{reference:_((()=>[y(i,{icon:"delete",size:"small",disabled:!D.value.length,style:{"margin-left":"10px"},onClick:l[6]||(l[6]=e=>R.value=!0)},{default:_((()=>l[18]||(l[18]=[x("删除")]))),_:1},8,["disabled"])])),default:_((()=>[l[19]||(l[19]=b("p",null,"确定要删除吗？",-1)),b("div",U,[y(i,{size:"small",type:"text",onClick:l[5]||(l[5]=e=>R.value=!1)},{default:_((()=>l[16]||(l[16]=[x("取消")]))),_:1}),y(i,{size:"small",type:"primary",onClick:W},{default:_((()=>l[17]||(l[17]=[x("确定")]))),_:1})])])),_:1},8,["visible"])]),y(n,{data:L.value,onSortChange:M,onSelectionChange:Q},{default:_((()=>[y(r,{type:"selection",width:"55"}),y(r,{align:"left",label:"id","min-width":"60",prop:"ID",sortable:"custom"}),y(r,{align:"left",label:"API路径","min-width":"150",prop:"path",sortable:"custom"}),y(r,{align:"left",label:"API分组","min-width":"150",prop:"apiGroup",sortable:"custom"}),y(r,{align:"left",label:"API简介","min-width":"150",prop:"description",sortable:"custom"}),y(r,{align:"left",label:"请求","min-width":"150",prop:"method",sortable:"custom"},{default:_((e=>[b("div",null,k(e.row.method)+" / "+k(v(e.row.method)),1)])),_:1}),y(r,{align:"left",fixed:"right",label:"操作",width:"200"},{default:_((e=>[y(i,{icon:"edit",size:"small",type:"text",onClick:l=>ue(e.row)},{default:_((()=>l[20]||(l[20]=[x("编辑")]))),_:2},1032,["onClick"]),y(i,{icon:"delete",size:"small",type:"text",onClick:l=>ie(e.row)},{default:_((()=>l[21]||(l[21]=[x("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),b("div",j,[y(p,{"current-page":q.value,"page-size":F.value,"page-sizes":[10,30,50,100],total:B.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:J,onSizeChange:Z},null,8,["current-page","page-size","total"])])]),y(m,{modelValue:le.value,"onUpdate:modelValue":l[12]||(l[12]=e=>le.value=e),"before-close":te,title:ee.value},{footer:_((()=>[b("div",O,[y(i,{size:"small",onClick:te},{default:_((()=>l[22]||(l[22]=[x("取 消")]))),_:1}),y(i,{size:"small",type:"primary",onClick:oe},{default:_((()=>l[23]||(l[23]=[x("确 定")]))),_:1})])])),default:_((()=>[y(c,{title:"新增API，需要在角色管理内配置权限才可使用"}),y(s,{ref_key:"apiForm",ref:X,model:S.value,rules:E.value,"label-width":"80px"},{default:_((()=>[y(t,{label:"路径",prop:"path"},{default:_((()=>[y(a,{modelValue:S.value.path,"onUpdate:modelValue":l[8]||(l[8]=e=>S.value.path=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),y(t,{label:"请求",prop:"method"},{default:_((()=>[y(o,{modelValue:S.value.method,"onUpdate:modelValue":l[9]||(l[9]=e=>S.value.method=e),placeholder:"请选择",style:{width:"100%"}},{default:_((()=>[(h(!0),g(w,null,V(T.value,(e=>(h(),C(u,{key:e.value,label:`${e.label}(${e.value})`,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),y(t,{label:"api分组",prop:"apiGroup"},{default:_((()=>[y(a,{modelValue:S.value.apiGroup,"onUpdate:modelValue":l[10]||(l[10]=e=>S.value.apiGroup=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),y(t,{label:"api简介",prop:"description"},{default:_((()=>[y(a,{modelValue:S.value.description,"onUpdate:modelValue":l[11]||(l[11]=e=>S.value.description=e),autocomplete:"off"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-1779c371"]]);export{D as default};
