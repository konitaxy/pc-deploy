/*! 
 Build based on gin-vue-admin 
 Time : 1754399312000 */
var e=Object.defineProperty,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,s=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,o=(e,a,l)=>new Promise(((t,s)=>{var o=e=>{try{r(l.next(e))}catch(a){s(a)}},i=e=>{try{r(l.throw(e))}catch(a){s(a)}},r=e=>e.done?t(e.value):Promise.resolve(e.value).then(o,i);r((l=l.apply(e,a)).next())}));import{r as i,L as r,b as u,o as d,c as n,f as m,d as p,w as c,g as h,l as g,e as v,G as y,H as f,a7 as b,Y as w,a8 as _,h as I,a9 as x,aa as V,ab as z,B as k,ac as j}from"../gva/pixel-index.1754399312000.js";import{g as N}from"./pixel-authority.17543993120002.js";import{C}from"./pixel-index.17543993120007.js";import{_ as U}from"./pixel-index.175439931200010.js";import{w as O}from"./pixel-warningBar.1754399312000.js";const S={class:"gva-table-box"},D={class:"gva-btn-list"},P={style:{"text-align":"right","margin-top":"8px"}},q={class:"gva-pagination"},B={style:{height:"60vh",overflow:"auto",padding:"0 12px"}},T=["src"],E=["src"],F={class:"dialog-footer"},J=Object.assign({name:"User"},{setup(e){i("/api");const J=(e,a)=>{e&&e.forEach((e=>{if(e.children&&e.children.length){const l={authorityId:e.authorityId,authorityName:e.authorityName,children:[]};J(e.children,l.children),a.push(l)}else{const l={authorityId:e.authorityId,authorityName:e.authorityName};a.push(l)}}))},R=i(1),G=i(0),H=i(10),L=i([]),Y=["https://metalposterpro.s3.us-east-1.amazonaws.com/static/headimg/border_1.jpeg","https://metalposterpro.s3.us-east-1.amazonaws.com/static/headimg/border_2.jpeg","https://metalposterpro.s3.us-east-1.amazonaws.com/static/headimg/border_3.jpeg","https://metalposterpro.s3.us-east-1.amazonaws.com/static/headimg/border_4.jpeg","https://metalposterpro.s3.us-east-1.amazonaws.com/static/headimg/border_5.jpeg","https://metalposterpro.s3.us-east-1.amazonaws.com/static/headimg/border_6.jpeg","https://metalposterpro.s3.us-east-1.amazonaws.com/static/headimg/border_7.jpeg","https://metalposterpro.s3.us-east-1.amazonaws.com/static/headimg/border_8.jpeg","https://metalposterpro.s3.us-east-1.amazonaws.com/static/headimg/border_9.jpeg","https://metalposterpro.s3.us-east-1.amazonaws.com/static/headimg/border_10.jpeg","https://metalposterpro.s3.us-east-1.amazonaws.com/static/headimg/border_11.jpeg","https://metalposterpro.s3.us-east-1.amazonaws.com/static/headimg/border_12.jpeg"],A=e=>{H.value=e,M()},K=e=>{R.value=e,M()},M=()=>o(this,null,(function*(){const e=yield b({page:R.value,pageSize:H.value});0===e.code&&(L.value=e.data.list,G.value=e.data.total,R.value=e.data.page,H.value=e.data.pageSize)}));r(L,(()=>{W()}));(()=>{o(this,null,(function*(){M();const e=yield N({page:1,pageSize:999});$(e.data.list)}))})();const Q=e=>{w.confirm("是否将此用户密码重置为123456?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>o(this,null,(function*(){const a=yield _({ID:e.ID});0===a.code?I({type:"success",message:a.msg}):I({type:"error",message:a.msg})}))))},W=()=>{L.value&&L.value.forEach((e=>{const a=e.authorities&&e.authorities.map((e=>e.authorityId));e.authorityIds=a}))},X=i(null),Z=i([]),$=e=>{Z.value=[],J(e,Z.value)},ee=e=>o(this,null,(function*(){0===(yield x({id:e.ID})).code&&(I.success("删除成功"),e.visible=!1,yield M())})),ae=i({username:"",password:"",nickName:"",headerImg:"",authorityId:"",authorityIds:[]}),le=i({userName:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:5,message:"最低5位字符",trigger:"blur"}],password:[{required:!0,message:"请输入用户密码",trigger:"blur"},{min:6,message:"最低6位字符",trigger:"blur"}],nickName:[{required:!0,message:"请输入用户昵称",trigger:"blur"}],authorityId:[{required:!0,message:"请选择用户角色",trigger:"blur"}]}),te=i(null),se=()=>o(this,null,(function*(){ae.value.authorityId=ae.value.authorityIds[0],te.value.validate((e=>o(this,null,(function*(){if(e){const e=((e,o)=>{for(var i in o||(o={}))l.call(o,i)&&s(e,i,o[i]);if(a)for(var i of a(o))t.call(o,i)&&s(e,i,o[i]);return e})({},ae.value);if("add"===re.value){0===(yield V(e)).code&&(I({type:"success",message:"创建成功"}),yield M(),ie())}if("edit"===re.value){0===(yield z(e)).code&&(I({type:"success",message:"编辑成功"}),yield M(),ie())}}}))))})),oe=i(!1),ie=()=>{te.value.resetFields(),ae.value.headerImg="",ae.value.authorityIds=[],oe.value=!1},re=i("add"),ue=()=>{re.value="add",oe.value=!0},de=(e,a)=>o(this,null,(function*(){if(a)return;yield k();0===(yield j({ID:e.ID,authorityIds:e.authorityIds})).code&&I({type:"success",message:"角色设置成功"})}));return(e,a)=>{const l=u("el-button"),t=u("el-table-column"),s=u("el-cascader"),o=u("el-popover"),i=u("el-table"),r=u("el-pagination"),b=u("el-input"),w=u("el-form-item"),_=u("el-option"),I=u("el-select"),x=u("el-form"),V=u("el-dialog");return d(),n("div",null,[m(O,{title:"注：右上角头像下拉可切换角色"}),p("div",S,[p("div",D,[m(l,{size:"small",type:"primary",icon:"plus",onClick:ue},{default:c((()=>a[8]||(a[8]=[h("新增用户")]))),_:1})]),m(i,{data:L.value,"row-key":"ID"},{default:c((()=>[m(t,{align:"left",label:"头像","min-width":"75"},{default:c((e=>[m(C,{style:{"margin-top":"8px"},"pic-src":e.row.headerImg},null,8,["pic-src"])])),_:1}),m(t,{align:"left",label:"ID","min-width":"50",prop:"ID"}),m(t,{align:"left",label:"用户名","min-width":"150",prop:"userName"}),m(t,{align:"left",label:"昵称","min-width":"150",prop:"nickName"}),m(t,{align:"left",label:"手机号","min-width":"180",prop:"phone"}),m(t,{align:"left",label:"邮箱","min-width":"180",prop:"email"}),m(t,{align:"left",label:"用户角色","min-width":"200"},{default:c((e=>[m(s,{modelValue:e.row.authorityIds,"onUpdate:modelValue":a=>e.row.authorityIds=a,options:Z.value,"show-all-levels":!1,"collapse-tags":"",props:{multiple:!0,checkStrictly:!0,label:"authorityName",value:"authorityId",disabled:"disabled",emitPath:!1},clearable:!1,onVisibleChange:a=>{de(e.row,a)},onRemoveTag:()=>{de(e.row,!1)}},null,8,["modelValue","onUpdate:modelValue","options","onVisibleChange","onRemoveTag"])])),_:1}),m(t,{label:"操作","min-width":"250",fixed:"right"},{default:c((e=>[m(o,{visible:e.row.visible,"onUpdate:visible":a=>e.row.visible=a,placement:"top",width:"160"},{reference:c((()=>[m(l,{type:"text",icon:"delete",size:"small"},{default:c((()=>a[11]||(a[11]=[h("删除")]))),_:1})])),default:c((()=>[a[12]||(a[12]=p("p",null,"确定要删除此用户吗",-1)),p("div",P,[m(l,{size:"small",type:"text",onClick:a=>e.row.visible=!1},{default:c((()=>a[9]||(a[9]=[h("取消")]))),_:2},1032,["onClick"]),m(l,{type:"primary",size:"small",onClick:a=>ee(e.row)},{default:c((()=>a[10]||(a[10]=[h("确定")]))),_:2},1032,["onClick"])])])),_:2},1032,["visible","onUpdate:visible"]),m(l,{type:"text",icon:"edit",size:"small",onClick:a=>{return l=e.row,re.value="edit",ae.value=JSON.parse(JSON.stringify(l)),void(oe.value=!0);var l}},{default:c((()=>a[13]||(a[13]=[h("编辑")]))),_:2},1032,["onClick"]),m(l,{type:"text",icon:"magic-stick",size:"small",onClick:a=>Q(e.row)},{default:c((()=>a[14]||(a[14]=[h("重置密码")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),p("div",q,[m(r,{"current-page":R.value,"page-size":H.value,"page-sizes":[10,30,50,100],total:G.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:K,onSizeChange:A},null,8,["current-page","page-size","total"])])]),m(V,{modelValue:oe.value,"onUpdate:modelValue":a[7]||(a[7]=e=>oe.value=e),"custom-class":"user-dialog",title:"用户","show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1},{footer:c((()=>[p("div",F,[m(l,{size:"small",onClick:ie},{default:c((()=>a[15]||(a[15]=[h("取 消")]))),_:1}),m(l,{size:"small",type:"primary",onClick:se},{default:c((()=>a[16]||(a[16]=[h("确 定")]))),_:1})])])),default:c((()=>[p("div",B,[m(x,{ref_key:"userForm",ref:te,rules:le.value,model:ae.value,"label-width":"80px"},{default:c((()=>["add"===re.value?(d(),g(w,{key:0,label:"用户名",prop:"userName"},{default:c((()=>[m(b,{modelValue:ae.value.userName,"onUpdate:modelValue":a[0]||(a[0]=e=>ae.value.userName=e)},null,8,["modelValue"])])),_:1})):v("",!0),"add"===re.value?(d(),g(w,{key:1,label:"密码",prop:"password"},{default:c((()=>[m(b,{modelValue:ae.value.password,"onUpdate:modelValue":a[1]||(a[1]=e=>ae.value.password=e)},null,8,["modelValue"])])),_:1})):v("",!0),m(w,{label:"昵称",prop:"nickName"},{default:c((()=>[m(b,{modelValue:ae.value.nickName,"onUpdate:modelValue":a[2]||(a[2]=e=>ae.value.nickName=e)},null,8,["modelValue"])])),_:1}),m(w,{label:"手机号",prop:"phone"},{default:c((()=>[m(b,{modelValue:ae.value.phone,"onUpdate:modelValue":a[3]||(a[3]=e=>ae.value.phone=e)},null,8,["modelValue"])])),_:1}),m(w,{label:"邮箱",prop:"email"},{default:c((()=>[m(b,{modelValue:ae.value.email,"onUpdate:modelValue":a[4]||(a[4]=e=>ae.value.email=e)},null,8,["modelValue"])])),_:1}),m(w,{label:"用户角色",prop:"authorityId"},{default:c((()=>[m(s,{modelValue:ae.value.authorityIds,"onUpdate:modelValue":a[5]||(a[5]=e=>ae.value.authorityIds=e),style:{width:"100%"},options:Z.value,"show-all-levels":!1,props:{multiple:!0,checkStrictly:!0,label:"authorityName",value:"authorityId",disabled:"disabled",emitPath:!1},clearable:!1},null,8,["modelValue","options"])])),_:1}),m(w,{label:"头像",style:{"max-width":"200px"}},{default:c((()=>[m(I,{modelValue:ae.value.headerImg,"onUpdate:modelValue":a[6]||(a[6]=e=>ae.value.headerImg=e)},{label:c((()=>[p("img",{style:{scale:"0.8","max-width":"40px"},class:"select-img object-fit-scale w-100 h-100",src:ae.value.headerImg},null,8,T)])),default:c((()=>[(d(),n(y,null,f(Y,(e=>m(_,{value:e},{default:c((()=>[p("img",{class:"object-fit-scale w-100 h-100",style:{"max-width":"50px"},src:e},null,8,E)])),_:2},1032,["value"]))),64))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])])])),_:1},8,["modelValue"]),m(U,{ref_key:"chooseImg",ref:X,target:ae.value,"target-key":"headerImg"},null,8,["target"])])}}});export{J as default};
